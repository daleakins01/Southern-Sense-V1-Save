<!-- src/_includes/header.html -->
<header class="site-header">
  <div class="brand">
    <h1>Southern Sense</h1>
    <p class="muted">Candles, Refills &amp; Southern Comforts</p>
  </div>

  <nav class="main-nav" aria-label="Main Navigation">
    <a href="/">Home</a>
    <a href="/shop/">Shop</a>
    <a href="/refill-program/">Refill Program</a>
    <a href="/about/">About</a>
    <a href="/account/">Account</a>
    <a id="admin-link" href="/admin/" style="display:none;">Admin Panel</a>
  </nav>
</header>

<style>
  header.site-header {
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:12px 0 16px 0;
    border-bottom:2px solid rgba(164,123,91,0.15);
  }
  .brand h1 {
    font-family:"Cormorant Garamond",serif;
    font-weight:700;
    color:#6a4a38;
    font-size:30px;
    margin:0;
    letter-spacing:0.6px;
  }
  .brand p {
    font-size:13px;
    color:#7a6b60;
    margin:2px 0 0 0;
  }
  nav.main-nav a {
    text-decoration:none;
    color:#6a4a38;
    font-weight:600;
    padding:8px 12px;
    border-radius:8px;
    transition:background 0.2s;
  }
  nav.main-nav a:hover {
    background:rgba(164,123,91,0.08);
  }
</style>

<script type="module">
  import { getFirestore, doc, getDoc } from '/firebase-loader.js';
  import { getAuth, onAuthStateChanged } from '/firebase-loader.js';

  const auth = window.firebaseAuth || getAuth();
  const db = window.firebaseDB || getFirestore();
  const adminLink = document.getElementById('admin-link');

  async function showAdminLink(user) {
    try {
      if (!user) return;
      const uid = user.uid;
      const adminRef = doc(db, 'admins', uid);
      const adminSnap = await getDoc(adminRef);
      if (adminSnap.exists()) adminLink.style.display = 'inline-block';
    } catch (err) {
      console.warn('[Header] Admin check failed', err);
    }
  }

  onAuthStateChanged(auth, (user) => showAdminLink(user));
  window.addEventListener('firebase-ready', () => {
    if (auth.currentUser) showAdminLink(auth.currentUser);
  });
</script>
