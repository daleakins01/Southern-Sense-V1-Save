---
layout: layout
title: Refill Program
---

<script type="module">
    import { db, doc, getDoc } from '/firebase-loader.js';

    // --- DOM Elements ---
    const contentLoader = document.getElementById('content-loader');
    const refillContent = document.getElementById('refill-content');
    const mainHeading = document.getElementById('main-heading');
    const mainIntro = document.getElementById('main-intro');
    const stepsContainer = document.getElementById('steps-container');
    const faqSection = document.getElementById('faq-section');

    /**
     * Fetches the 'refillProgram' document from Firestore and injects content into the page.
     */
    async function loadRefillProgramContent() {
        // Show loader while fetching
        contentLoader.classList.remove('hidden');
        refillContent.classList.add('hidden');

        try {
            const refillRef = doc(db, 'siteContent', 'refillProgram');
            const docSnap = await getDoc(refillRef);

            if (docSnap.exists()) {
                const data = docSnap.data();

                // 1. Inject Main Heading and Introduction
                mainHeading.textContent = data.heading || 'The Southern Sense Refill Program';
                mainIntro.innerHTML = data.intro || '<p>Content missing: Intro paragraph for Refill Program.</p>';

                // 2. Inject Step-by-Step Guide
                const steps = [
                    { number: 1, title: data.step1Title, text: data.step1Text },
                    { number: 2, title: data.step2Title, text: data.step2Text },
                    { number: 3, title: data.step3Title, text: data.step3Text },
                ];
                
                let stepsHtml = '';
                steps.forEach(step => {
                    const stepTitle = step.title || `Step ${step.number}: Title Missing`;
                    const stepText = step.text || 'Step description is missing. Update via Admin CMS.';

                    stepsHtml += `
                        <div class="flex flex-col md:flex-row items-start space-y-4 md:space-y-0 md:space-x-6 p-6 bg-parchment rounded-lg shadow-md">
                            <div class="flex-shrink-0 w-12 h-12 bg-burnt-orange text-parchment rounded-full flex items-center justify-center text-xl font-bold font-playfair shadow-lg">
                                ${step.number}
                            </div>
                            <div class="flex-grow">
                                <h3 class="text-2xl font-playfair text-charcoal mb-2">${stepTitle}</h3>
                                <p class="text-stone leading-relaxed">${stepText}</p>
                            </div>
                        </div>
                    `;
                });
                stepsContainer.innerHTML = stepsHtml;

                // 3. Inject FAQ (This assumes FAQ is stored as a structured array or string with HTML)
                // For simplicity, we assume the Admin CMS stores the FAQ content as formatted HTML text.
                faqSection.querySelector('h2').textContent = data.faqHeading || 'Frequently Asked Questions';
                faqSection.querySelector('#faq-body').innerHTML = data.faqContent || '<p>FAQ content is missing. Please add common questions and answers.</p>';
                
            } else {
                // Document not found
                mainHeading.textContent = 'Program Details Missing';
                mainIntro.innerHTML = '<p class="text-red-600">The core "refillProgram" document could not be found in the database. Please check Firestore.</p>';
                stepsContainer.innerHTML = '';
                faqSection.querySelector('h2').textContent = 'FAQ';
                faqSection.querySelector('#faq-body').innerHTML = '';
            }

        } catch (error) {
            console.error("Error loading Refill Program content:", error);
            mainHeading.textContent = 'Error Loading Page';
            mainIntro.innerHTML = '<p class="text-red-600">A network error occurred while fetching content. Please try again later.</p>';
            stepsContainer.innerHTML = '';
        } finally {
            // Hide loader and show content
            contentLoader.classList.add('hidden');
            refillContent.classList.remove('hidden');
        }
    }

    document.addEventListener('DOMContentLoaded', loadRefillProgramContent);

</script>

<main class="container mx-auto px-4 py-12 min-h-screen">
    
    <div id="content-loader" class="flex justify-center items-center h-64">
        <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-charcoal"></div>
    </div>

    <div id="refill-content" class="hidden">
        
        <header class="max-w-4xl mx-auto text-center mb-12">
            <p class="text-sm font-semibold uppercase tracking-wider text-burnt-orange mb-3">Sustainability in Scents</p>
            <h1 id="main-heading" class="text-5xl font-playfair text-charcoal mb-6">
                Loading Heading...
            </h1>
            <div id="main-intro" class="text-xl text-stone leading-relaxed">
                </div>
        </header>

        <section class="max-w-4xl mx-auto mb-16">
            <h2 class="text-4xl font-playfair text-charcoal mb-10 text-center">How It Works</h2>
            <div id="steps-container" class="space-y-8">
                </div>
        </section>

        <section class="max-w-4xl mx-auto p-10 bg-white rounded-lg shadow-xl border-t-4 border-stone">
            <h2 class="text-3xl font-playfair text-charcoal mb-4">Why Refill?</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-stone">
                <div>
                    <h3 class="font-semibold text-xl mb-2 text-burnt-orange">Eco-Friendly</h3>
                    <p>Reduce glass waste by reusing your beautiful Southern Sense vessel. It's a small change that makes a significant difference for the planet.</p>
                </div>
                <div>
                    <h3 class="font-semibold text-xl mb-2 text-burnt-orange">Cost-Effective</h3>
                    <p>Receive a discount on your purchase since you are only paying for the wax and fragrance. It's our thank you for participating in a sustainable practice.</p>
                </div>
            </div>
        </section>

        <section id="faq-section" class="max-w-4xl mx-auto mt-16">
            <h2 class="text-4xl font-playfair text-charcoal mb-8 text-center">
                Frequently Asked Questions
            </h2>
            <div id="faq-body" class="space-y-6 text-stone">
                </div>
        </section>
    </div>
</main>