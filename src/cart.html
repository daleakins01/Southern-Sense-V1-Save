---
layout: layout
title: Shopping Cart
---

<script src="https://www.paypal.com/sdk/js?client-id=sb&currency=USD"></script>
<script type="module">
    import { renderCart, initPayPal, attachFormListeners } from '/src/cart.js';
    
    // --- DOM Elements ---
    const cartLoader = document.getElementById('cart-loader');
    const cartContent = document.getElementById('cart-content');
    const cartEmpty = document.getElementById('cart-empty');
    const checkoutForm = document.getElementById('checkout-form');
    const formError = document.getElementById('form-error');

    /**
     * Initializes the Cart Page and all dependent components.
     */
    async function initializeCart() {
        // 1. Initial render of cart items and totals
        renderCart(); 

        // 2. Hide loader and show content (renderCart handles the empty/full state)
        cartLoader.classList.add('hidden');
        cartEmpty.classList.remove('hidden'); // Initially show empty, will be hidden by renderCart if items exist

        // 3. Setup form listeners for real-time validation feedback
        attachFormListeners();

        // 4. Initialize PayPal buttons (must be called after totals are calculated)
        initPayPal(formError);
    }

    document.addEventListener('DOMContentLoaded', initializeCart);

</script>

<main class="container mx-auto px-4 py-12 min-h-screen">
    
    <header class="max-w-4xl mx-auto text-center mb-12">
        <h1 class="text-5xl font-playfair text-charcoal mb-4">Your Shopping Cart</h1>
        <p class="text-lg text-stone leading-relaxed">Review your items and complete your order.</p>
    </header>

    <div id="cart-loader" class="flex justify-center items-center h-48">
        <div class="animate-spin rounded-full h-12 w-12 border-t-4 border-b-4 border-burnt-orange"></div>
    </div>

    <div id="cart-empty" class="text-center py-20 hidden">
        <p class="text-2xl font-playfair text-stone mb-6">Your cart is currently empty.</p>
        <a href="/shop/" class="px-8 py-3 bg-burnt-orange text-parchment font-bold rounded-lg shadow-lg hover:bg-burnt-orange/80 transition duration-300">
            Start Shopping Now
        </a>
    </div>

    <div id="cart-content" class="hidden">
        
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">
            
            <div class="lg:col-span-2 space-y-6">
                <h2 class="text-3xl font-playfair text-charcoal mb-4 border-b pb-2">Items in Cart</h2>
                <div id="cart-items-container" class="space-y-4">
                    </div>
            </div>

            <div class="lg:col-span-1 sticky top-24">
                <div class="bg-parchment p-6 rounded-lg shadow-xl">
                    <h2 class="text-3xl font-playfair text-burnt-orange mb-6">Order Summary</h2>
                    
                    <div class="space-y-3 border-b border-stone/30 pb-4 mb-4">
                        <div class="flex justify-between text-charcoal">
                            <span>Subtotal</span>
                            <span id="cart-subtotal" class="font-medium">$0.00</span>
                        </div>
                        <div class="flex justify-between text-charcoal">
                            <span>Shipping (Flat Rate)</span>
                            <span id="cart-shipping" class="font-medium">$0.00</span>
                        </div>
                    </div>
                    
                    <div class="flex justify-between text-2xl font-bold text-charcoal mb-6">
                        <span>Order Total</span>
                        <span id="cart-total">$0.00</span>
                    </div>

                    <h3 class="text-xl font-playfair text-charcoal mb-4">Shipping & Contact Info</h3>
                    
                    <form id="checkout-form" class="space-y-4">
                        <input type="text" name="firstName" placeholder="First Name *" required 
                               class="w-full p-3 border border-stone/30 rounded-lg">
                        <input type="text" name="lastName" placeholder="Last Name *" required 
                               class="w-full p-3 border border-stone/30 rounded-lg">
                        <input type="email" name="email" placeholder="Email Address *" required 
                               class="w-full p-3 border border-stone/30 rounded-lg">
                        <input type="text" name="address" placeholder="Street Address *" required 
                               class="w-full p-3 border border-stone/30 rounded-lg">
                        <div class="grid grid-cols-2 gap-2">
                            <input type="text" name="city" placeholder="City *" required 
                                   class="w-full p-3 border border-stone/30 rounded-lg">
                            <input type="text" name="state" placeholder="State/Region *" required 
                                   class="w-full p-3 border border-stone/30 rounded-lg">
                        </div>
                        <input type="text" name="zip" placeholder="Zip/Postal Code *" required 
                               class="w-full p-3 border border-stone/30 rounded-lg">
                    </form>

                    <p id="form-error" class="text-sm font-semibold text-red-600 mt-4 hidden">
                        </p>

                    <div class="mt-8 border-t pt-4">
                        <h3 class="text-xl font-playfair text-charcoal mb-4">Pay with PayPal</h3>
                        <div id="paypal-loader" class="text-center text-sm text-stone mb-4">
                            Loading payment buttons...
                        </div>
                        <div id="paypal-button-container"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>